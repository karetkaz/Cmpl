/// Fill a rectangle on the `image` specified by the coordinates with the given `color`
void fillRect(Image image, int32 x0, int32 y0, int32 x1, int32 y1, int32 incl, uint32 color) {
	static if (preferNativeCalls && struct(Image.fillRect) != null) {
		return Image.fillRect(image, x0, y0, x1, y1, incl, color);
	}

	if (x0 > x1) {
		int32 t = x0;
		x0 = x1;
		x1 = t;
	}
	if (y0 > y1) {
		int32 t = y0;
		y0 = y1;
		y1 = t;
	}
	x1 += incl;
	y1 += incl;

	for (int32 y = y0; y < y1; y += 1) {
		for (int32 x = x0; x < x1; x += 1) {
			image.set(x, y, color);
		}
	}
}

/// Fill a rectangle on the `image` specified by the coordinates with the given `color`
inline fillRect(Image image, int32 x0, int32 y0, int32 x1, int32 y1, uint32 color) = image.fillRect(x0, y0, x1, y1, 0, color);

/// Draw a rectangle on the `image` specified by the coordinates with the given `width` and `color`
void drawRect(Image image, int32 x0, int32 y0, int32 x1, int32 y1, int32 width, uint32 color) {
	if (y0 > y1) {
		int32 t = y1;
		y1 = y0;
		y0 = t;
	}
	if (x0 > x1) {
		int32 t = x1;
		x1 = x0;
		x0 = t;
	}

	int32 half1 = (width - 0) / 2;
	int32 half2 = (width - 1) / 2;
	x0 -= half1;
	y0 -= half1;
	x1 += half2;
	y1 += half2;

	if (x1 - x0 <= 2 * width || y1 - y0 <= 2 * width) {
		// no gap between top and bottom or left and right; draw all at once
		return image.fillRect(x0, y0, x1, y1, color);
	}

	image.fillRect(x0, y0, x1, y0 + width, color);					// top
	image.fillRect(x0, y0 + width, x0 + width, y1 - width, color);	// left
	image.fillRect(x1 - width, y0 + width, x1, y1 - width, color);	// right
	image.fillRect(x0, y1 - width, x1, y1, color);					// bottom
}

/// Draw a rectangle on the `image` specified by the coordinates with the given `color`
inline drawRect(Image image, int32 x0, int32 y0, int32 x1, int32 y1, uint32 color) = image.drawRect(x0, y0, x1, y1, 1, color);

/// Fill a rectangle on the `image` specified by `roi` with the given `color`
void fillRect(Image image, Rect roi!, uint32 color) {
	if (roi.empty()) {
		return;
	}
	image.fillRect(roi.x0, roi.y0, roi.x1, roi.y1, color);
}

/// Draw a rectangle on the `image` specified by `roi` with the given `color`
void drawRect(Image image, Rect roi!, uint32 color) {
	if (roi.empty()) {
		return;
	}
	image.drawRect(roi.x0, roi.y0, roi.x1, roi.y1, 1, color);
}
